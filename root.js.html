<script>
  window.vue = new Vue({
    el: "#app",
    data: {
      page: "root",
      my_class: "",
      my_number: "",
      my_name: "",
      model: {},
    },
    methods: {
      direct() {
        google.script.history.replace(
          null,
          {
            class: this.my_class,
            number: this.my_number,
            name: this.my_name,
          },
          ""
        );

        this.page = "bookmark";
      },
    },
    computed: {
      url() {
        let url = new URL(`https:\/\/docs.google.com\/forms\/d\/e\/${this.model[0]}\/viewform`);
        url.searchParams.set("embedded", "true");
        url.searchParams.set(`entry.${this.model[1]}`, this.my_class);
        url.searchParams.set(`entry.${this.model[3]}`, this.my_number);
        url.searchParams.set(`entry.${this.model[5]}`, this.my_name);
        url.searchParams.set(`entry.${this.model[6]}`, window.today);
        return url;
      },
    },
    created() {
      google.script.run
        .withSuccessHandler(function (data) {
          window.vue.model = data;
        })
        .login();
      this.my_class = window.me[0];
      this.my_number = window.me[1];
      this.my_name = window.me[2];
    },
    mounted() {
      if (!this.my_class || !this.my_number || !this.my_name) {
        new bootstrap.Modal(document.getElementById("setting")).show();
      }
    },
  });
</script>
<script>
  document.getElementById("setting").addEventListener("hidden.bs.modal", function () {
    window.vue.page = "root";
  });
</script>
